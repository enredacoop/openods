<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <link data_conf="base_url" rel="icon" type="image/png" href="images/favicon.png">
    <title>Open ODS</title>


    <!-- CSS Externs -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.0/css/all.css" integrity="sha384-Mmxa0mLqhmOeaE8vgOSbKacftZcsNYDjQzuCOm6D02luYSzBG8vpaOykv9lFQ51Y" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <link href="../css/main.css" rel="stylesheet">

    <!-- Mapbox Library -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.css' rel='stylesheet' />

    <!-- JS Externs -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <!-- Chart.js Library-->
    <script src="../js/Chart.js"></script>

    <!-- Custom Javascripts -->
    <script src="../js/main.js"></script>
  </head>
  <body id="profile-data" class="d-flex flex-column h-100" ondragstart="return false">

    <!-- Navbar -->
    <div w3-include-html="../include/in_navbar_app.html"></div>

    <main role="main" class="flex-shrink-0">
      <section class="section-data">
        <div class="container">
          <!-- Título -->
          <div class="row wrapper-block-title">
            <div class="col-12 block-title">
              <div class="row">
                <div class="col-12">
                  <div class="wrapper-title">
                    <h2>
                      <span id="title-city"></span
                      ><span id="title"
                        >Objetivos y metas de desarrollo sostenible</span
                      >
                    </h2>
                  </div>
                </div>
                <div class="col-6">
                  <a
                    id="reset-data-ods"
                    href="#"
                    class="badge badge-primary badge-reset hidden"
                    >Ver puntuación general</a
                  >
                  <!--a id="reset-data-map" href="#" class="badge badge-primary badge-reset">Volver al listado</a-->
                </div>
                <div class="col-6 text-right">
                  <div class="block-search">
                    <input
                      id="search-cities-selected"
                      list="search-cities"
                      name="browser"
                    />
                    <datalist id="search-cities"></datalist>
                    <a id="clear-seach-cities" class="submit"
                      ><i class="fas fa-times"></i
                    ></a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Gráficas -->
          <div class="row justify-content-center ptb-30">
            <div class="col-6">
              <div class="wrapper-infochart">
                <div class="block-infochart">
                  <h5>
                    Puntuación Estado
                    <i
                      class="far fa-question-circle icon-help"
                      data-toggle="tooltip"
                      data-placement="right"
                      title="Puntuación general del Estado."
                    ></i>
                  </h5>
                  <span id="infochart-state"></span>
                </div>
                <div class="block-infochart">
                  <h5>
                    Media ciudades
                    <i
                      class="far fa-question-circle icon-help"
                      data-toggle="tooltip"
                      data-placement="right"
                      title="Puntuación media de las ciudades. Esta puntuación es la media de los valores que se están visualizando en la gráfica."
                    ></i>
                  </h5>
                  <span id="infochart-global"></span>
                </div>
                <div class="block-infochart hidden">
                  <h5>
                    Ranking
                    <i
                      class="far fa-question-circle icon-help"
                      data-toggle="tooltip"
                      data-placement="right"
                      title="Posición de la ciudad seleccionada en el ranking."
                    ></i>
                  </h5>
                  <span id="infochart-ranking"></span>
                  <span id="infochart-number-cities" class="small-info"></span>
                </div>
                <div class="block-infochart hidden">
                  <h5>
                    Puntuación
                    <i
                      class="far fa-question-circle icon-help"
                      data-toggle="tooltip"
                      data-placement="right"
                      title="Puntuación que tiene la ciudad seleccionada. Si está marcado algún ODS, esta puntuación es la que tiene la ciudad en dicho ODS."
                    ></i>
                  </h5>
                  <span id="infochart-score"></span>
                </div>
              </div>
              <canvas id="my-chart"></canvas>
            </div>
            <div class="col-6">
              <canvas id="my-chart-comparative"></canvas>
            </div>
          </div>

          <div class="row justify-content-around">
            <div class="col-4 m-10">
              <div class="legend-global">
                <h4>
                  Puntuación
                  <i
                    class="far fa-question-circle icon-help"
                    data-toggle="tooltip"
                    data-placement="right"
                    title="Cada color indica el grado de mejora de los ODS respecto a la puntuación del año anterior."
                  ></i>
                </h4>
                <div>
                  <span class="bg-green"></span
                  ><span>Objetivo mejorado satisfactoriamente</span>
                </div>
                <div>
                  <span class="bg-yellow"></span
                  ><span>Objetivo poco mejorado</span>
                </div>
                <div>
                  <span class="bg-orange"></span
                  ><span>Objetivo poco empeorado</span>
                </div>
                <div>
                  <span class="bg-red"></span
                  ><span>Objetivo muy empeorado</span>
                </div>
                <div>
                  <span class="bg-none"></span
                  ><span>
                    Información no disponible
                    <i
                      class="far fa-question-circle"
                      data-toggle="tooltip"
                      data-placement="right"
                      title="El año anterior no había ninguna puntuación para el objetivo."
                    ></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="col-4 m-10">
              <div class="legend-global">
                <h4>
                  Comparativa
                  <i
                    class="far fa-question-circle icon-help"
                    data-toggle="tooltip"
                    data-placement="right"
                    title="En el gráfico se muestra la puntuación de los ODS. Cuando hay una ciudad seleccionada se puede comparar visualmente la puntuación de sus ODS con el del Estado."
                  ></i>
                </h4>
                <div>
                  <span class="bg-gray-trans"></span
                  ><span
                    >Puntuación ODS del estado
                    <a
                      href="https://dashboards.sdgindex.org/#/ESP"
                      target="_blank"
                      class="help"
                      ><i class="fas fa-external-link-alt"></i> Fuente</a
                    ></span
                  >
                </div>
                <div>
                  <span class="bg-primary"></span
                  ><span>Puntuación ODS ciudad seleccionada</span>
                </div>
              </div>
            </div>
          </div>

          <!-- SDGS -->
          <div class="row">
            <div class="col-12 block-sdgs">
              <ul>
                <li>
                  <button class="sdg sdg_01" data-sdg="01">
                    <img src="../images/sdgs/es/sdg_01.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_02" data-sdg="02">
                    <img src="../images/sdgs/es/sdg_02.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_03" data-sdg="03">
                    <img src="../images/sdgs/es/sdg_03.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_04" data-sdg="04">
                    <img src="../images/sdgs/es/sdg_04.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_05" data-sdg="05">
                    <img src="../images/sdgs/es/sdg_05.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_06" data-sdg="06">
                    <img src="../images/sdgs/es/sdg_06.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_07" data-sdg="07">
                    <img src="../images/sdgs/es/sdg_07.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_08" data-sdg="08">
                    <img src="../images/sdgs/es/sdg_08.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_09" data-sdg="09">
                    <img src="../images/sdgs/es/sdg_09.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_10" data-sdg="10">
                    <img src="../images/sdgs/es/sdg_10.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_11" data-sdg="11">
                    <img src="../images/sdgs/es/sdg_11.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_12" data-sdg="12">
                    <img src="../images/sdgs/es/sdg_12.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_13" data-sdg="13">
                    <img src="../images/sdgs/es/sdg_13.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_14" data-sdg="14">
                    <img src="../images/sdgs/es/sdg_14.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_15" data-sdg="15">
                    <img src="../images/sdgs/es/sdg_15.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_16" data-sdg="16">
                    <img src="../images/sdgs/es/sdg_16.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_17" data-sdg="17">
                    <img src="../images/sdgs/es/sdg_17.png" />
                  </button>
                </li>
                <li>
                  <button class="sdg sdg_18" data-sdg="18">
                    <img src="../images/sdgs/es/sdg_18.png" />
                  </button>
                </li>
              </ul>
            </div>
            <div class="col-12">
              <div id="data"></div>
            </div>
          </div>

          <!-- Indicators -->
          <div id="section-indicators" class="row hidden">
            <div class="col-2">
              <button class="sdg sdg_01">
                <img id="img-sdg" src="../images/sdgs/es/sdg_01.png" />
                <div>
                  <h6>Puntuación</h6>
                  <h3 id="score-sdg"></h3>
                </div>
              </button>
            </div>
            <div class="col-10">
              <div class="wrapper-tabs">
                <button data-tab="list-indicators" class="active">
                  Indicadores
                </button>
                <button data-tab="list-initiatives">Iniciativas</button>
              </div>
              <div class="block-tabs">
                <ul id="list-indicators" class="list-group"></ul>
                <ul id="list-initiatives" class="list-group hidden">
                  <li
                    class="list-group-item d-flex justify-content-between align-items-center"
                  >
                    <div
                      class="btn-tab collapsed"
                      data-toggle="collapse"
                      data-target="#collapse-1"
                      aria-expanded="false"
                      aria-controls="collapse-1"
                    >
                      Anim pariatur cliche reprehenderit
                      <div class="wrapper-info">
                        <div class="progress">
                          <div
                            class="progress-bar"
                            role="progressbar"
                            style="width: 25%;"
                            aria-valuenow="25"
                            aria-valuemin="0"
                            aria-valuemax="100"
                          >
                            25%
                          </div>
                        </div>
                        <div class="arrow">
                          <i class="fas fa-arrow-up text-green"></i>
                        </div>
                      </div>
                    </div>
                    <div
                      id="collapse-1"
                      class="wrapper-collapse collapse"
                      aria-labelledby="initiative-1"
                      data-parent="#list-initiatives"
                    >
                      <div>
                        Anim pariatur cliche reprehenderit, enim eiusmod high
                        life accusamus terry richardson ad squid. 3 wolf moon
                        officia aute, non cupidatat skateboard dolor brunch.
                        Food truck quinoa nesciunt laborum eiusmod. Brunch 3
                        wolf moon tempor, sunt aliqua put a bird on it squid
                        single-origin coffee nulla assumenda shoreditch et.
                        Nihil anim keffiyeh helvetica, craft beer labore wes
                        anderson cred nesciunt sapiente ea proident. Ad vegan
                        excepteur butcher vice lomo. Leggings occaecat craft
                        beer farm-to-table, raw denim aesthetic synth nesciunt
                        you probably haven't heard of them accusamus labore
                        sustainable VHS.
                      </div>
                    </div>
                  </li>
                  <li
                    class="list-group-item d-flex justify-content-between align-items-center"
                  >
                    <div
                      class="btn-tab collapsed"
                      data-toggle="collapse"
                      data-target="#collapse-2"
                      aria-expanded="false"
                      aria-controls="collapse-2"
                    >
                      Enim eiusmod high life accusamus terry
                      <div class="wrapper-info">
                        <div class="progress">
                          <div
                            class="progress-bar"
                            role="progressbar"
                            style="width: 79%;"
                            aria-valuenow="79"
                            aria-valuemin="0"
                            aria-valuemax="100"
                          >
                            79%
                          </div>
                        </div>
                        <div class="arrow">
                          <i
                            class="fas fa-arrow-up fa-rotate-45 text-yellow"
                          ></i>
                        </div>
                      </div>
                    </div>
                    <div
                      id="collapse-2"
                      class="wrapper-collapse collapse"
                      aria-labelledby="initiative-2"
                      data-parent="#list-initiatives"
                    >
                      <div>
                        Anim pariatur cliche reprehenderit, enim eiusmod high
                        life accusamus terry richardson ad squid. 3 wolf moon
                        officia aute, non cupidatat skateboard dolor brunch.
                        Food truck quinoa nesciunt laborum eiusmod. Brunch 3
                        wolf moon tempor, sunt aliqua put a bird on it squid
                        single-origin coffee nulla assumenda shoreditch et.
                        Nihil anim keffiyeh helvetica, craft beer labore wes
                        anderson cred nesciunt sapiente ea proident. Ad vegan
                        excepteur butcher vice lomo. Leggings occaecat craft
                        beer farm-to-table, raw denim aesthetic synth nesciunt
                        you probably haven't heard of them accusamus labore
                        sustainable VHS.
                      </div>
                    </div>
                  </li>
                  <li
                    class="list-group-item d-flex justify-content-between align-items-center"
                  >
                    <div
                      class="btn-tab collapsed"
                      data-toggle="collapse"
                      data-target="#collapse-3"
                      aria-expanded="false"
                      aria-controls="collapse-3"
                    >
                      Anderson cred nesciunt sapiente ea proident
                      <div class="wrapper-info">
                        <div class="progress">
                          <div
                            class="progress-bar"
                            role="progressbar"
                            style="width: 47.5%;"
                            aria-valuenow="47.5"
                            aria-valuemin="0"
                            aria-valuemax="100"
                          >
                            47.5%
                          </div>
                        </div>
                        <div class="arrow">
                          <i class="fas fa-arrow-down text-red"></i>
                        </div>
                      </div>
                    </div>
                    <div
                      id="collapse-3"
                      class="wrapper-collapse collapse"
                      aria-labelledby="initiative-3"
                      data-parent="#list-initiatives"
                    >
                      <div>
                        Anim pariatur cliche reprehenderit, enim eiusmod high
                        life accusamus terry richardson ad squid. 3 wolf moon
                        officia aute, non cupidatat skateboard dolor brunch.
                        Food truck quinoa nesciunt laborum eiusmod. Brunch 3
                        wolf moon tempor, sunt aliqua put a bird on it squid
                        single-origin coffee nulla assumenda shoreditch et.
                        Nihil anim keffiyeh helvetica, craft beer labore wes
                        anderson cred nesciunt sapiente ea proident. Ad vegan
                        excepteur butcher vice lomo. Leggings occaecat craft
                        beer farm-to-table, raw denim aesthetic synth nesciunt
                        you probably haven't heard of them accusamus labore
                        sustainable VHS.
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Map -->
          <div id="section-map" class="row">
            <div class="col-12">
              <div id="search"></div>
              <div id="mapbox-map" class="map"></div>

              <div class="loader loader--style1" title="0" id="loader">
                <svg
                  version="1.1"
                  id="loader-1"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  x="0px"
                  y="0px"
                  width="40px"
                  height="40px"
                  viewBox="0 0 40 40"
                  enable-background="new 0 0 40 40"
                  xml:space="preserve"
                >
                  <path
                    opacity="0.2"
                    fill="#000"
                    d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946
            s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634
            c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"
                  >
                    <path
                      fill="#000"
                      d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0
              C22.32,8.481,24.301,9.057,26.013,10.047z"
                    >
                      <animateTransform
                        attributeType="xml"
                        attributeName="transform"
                        type="rotate"
                        from="0 20 20"
                        to="360 20 20"
                        dur="0.5s"
                        repeatCount="indefinite"
                      ></animateTransform>
                    </path>
                  </path>
                </svg>

                <span>Cargando datos...</span>
              </div>

              <div class="legend-global over-map top-left">
                <h4>Puntuación global</h4>
                <div><span class="bg-score-80"></span><span>> 80</span></div>
                <div><span class="bg-score-70"></span><span>70 - 80</span></div>
                <div><span class="bg-score-60"></span><span>60 - 70</span></div>
                <div><span class="bg-score-50"></span><span>50 - 60</span></div>
                <div><span class="bg-score-40"></span><span>40 - 50</span></div>
                <div><span class="bg-score-30"></span><span>< 50</span></div>
                <div>
                  <span class="bg-score-none"></span
                  ><span>Información no disponible</span>
                </div>
              </div>

              <div class="legend-global over-map top-right">
                <h4>
                  Filtro
                  <i
                    class="far fa-question-circle icon-help"
                    data-toggle="tooltip"
                    data-placement="right"
                    data-html="true"
                    title="Realiza filtros rápidos. Estos filtros mostrarán en el mapa el tipo de entidad seleccionada. <b>Funcionalidad no disponible.</b>"
                  ></i>
                </h4>
                <div><a href="#">Ayuntamientos</a></div>
                <div><a href="#">Diputaciones</a></div>
                <div><a href="#">Comunidades Autónomas</a></div>
                <div><a href="#">Universidades</a></div>
                <div><a href="#">Empresas</a></div>
              </div>
            </div>
          </div>

        </div>
      </section>

    </main>

    <!-- Footer -->
    <div w3-include-html="../include/in_footer_app.html"></div>
  </body>

  <script>
    mapboxgl.accessToken =
      "pk.eyJ1IjoiY2FyY2FtY3VlLWVucmVkYSIsImEiOiJjangwYmo2NXgxOHhlNDVwbTRqaW91anc2In0.1dAfMT9l7IJ0SPnC_NRydQ";

    // límites para el mapa
    var bounds = [
      [-23.601355, 24.289842], // coordenadas del suroeste [lng, lat]
      [7.0505, 44.498708] // coordenadas del noreste [lng, lat]
    ];
    var map = new mapboxgl.Map({
      container: "mapbox-map", // contenedor donde se pintará el mapa
      style: "mapbox://styles/carcamcue-enreda/cjwufmtju1bi21dk9ajsw061y", // estilo del mapa mapbox://styles/mapbox/light-v10
      center: [-4.045691, 40.214799], // posición inicial [lng, lat]
      //minZoom: 5, // mínimo nivel de zoom
      zoom: 4,
      minZoom: 3, // nivel mínimo de zoom
      //zoom: 5, // nivel de zoom
      //maxBounds: bounds // límite desplazamiento mapa
      attributionControl: false, // quitar atribuciones
      logoPosition: "bottom-right" // posición logo mapbox
    });

    var overlay = document.getElementById("map-overlay"); // bloque para mostrar información
    // Popup para mostrar título
    var popup = new mapboxgl.Popup({
      closeButton: false,
      className: "popup-map"
    });
    var hoveredStateId = null; // estado del hover del ratón
    var zoomThreshold = 8; // nivel de zoom de cambio
    var zoomClick = 3; // nivel de zoom al hacer click

    // evento - al cargar el mapa
    map.on("load", function() {
      /*map.addSource('ods-cities', { // identificador de los datos
				  type: 'vector', //tipo
				  url: 'mapbox://carcamcue-enreda.2cn43okn', // origen de donde se obtienen los datos
				});*/
      map.addSource("ods-cities", {
        // identificador de los datos
        type: "vector", //tipo
        url: "mapbox://carcamcue-enreda.dh664yoq" // origen de donde se obtienen los datos
      });
      //debugger;
      /*				map.addSource('ods-cities', { // identificador de los datos
				  type: 'geojson', //tipo
				  data: 'data/espana-municipios.geojson', // origen de donde se obtienen los datos
				  'generateId': true // variable para generar automáticamente ids, se utiliza para el hover
				});

*/

      // Modificar idioma mapa
      //map.setLayoutProperty('country-label', 'text-field', ['get', 'name_es']);

      // Quitar labels de ciudades y pueblos
      map.style.stylesheet.layers.forEach(function(layer) {
        if (layer.type === "symbol") {
          // map.removeLayer(layer.id);
        }
      });

      // añadir capa
      /*				map.addLayer({
					'id': 'global-shapes', // identificador
                'source': 'global', // id los datos
                'type': 'fill',	// tipo de capa (fill, line, circle...)
                'maxzoom': 5, // zoom para controlar cuándo se visualiza la capa
                'paint': {
                    "fill-outline-color": "#FFFFFF", // contorno de la forma
                    "fill-color": "#000000",
                    "fill-opacity": ["case", ["boolean", ["feature-state", "hover"], false], 1, 0.5], // transparencia
                }
				});
*/
      /*map.addLayer({
            'id': 'ods-cities-shapes', // identificador
            'source': 'ods-cities', // id los datos
            'source-layer': 'data-clm14k', // id los datos
            'type': 'fill',	// tipo de capa (fill, line, circle...)
            'minzoom': 1,
            //'maxzoom': zoomThreshold, // zoom para controlar cuándo se visualiza la capa
            'paint': {
                "fill-outline-color": "#FFFFFF", // contorno de la forma
                "fill-opacity": ["case", ["boolean", ["feature-state", "hover"], false], 1, 0.5], // transparencia


                'fill-color': "#f2ecc9", // color de relleno
                'fill-color': [ // color de relleno según valores
												'interpolate',
												['linear'],
												['get', 'score'], // cast de string a number
													0, bg_none,
													30, bg_score_30,
													40, bg_score_40,
													50, bg_score_50,
													60, bg_score_60,
													70, bg_score_70,
													80, bg_score_80
												],




								
            }
        });*/

      map.addLayer({
        id: "ods-cities-shapes", // identificador
        source: "ods-cities", // id los datos
        "source-layer": "data-points-data-1pwh00", // id los datos
        type: "circle", // tipo de capa (fill, line, circle...)
        minzoom: 1,
        //'maxzoom': zoomThreshold, // zoom para controlar cuándo se visualiza la capa
        paint: {
          "circle-radius": [
            "interpolate",
            ["linear"],
            ["get", "score"], // cast de string a number
            0,
            4,
            30,
            5,
            40,
            6,
            50,
            7,
            60,
            8,
            70,
            9,
            80,
            10
          ],
          "circle-color": [
            // color de relleno según valores
            "interpolate",
            ["linear"],
            ["get", "score"], // cast de string a number
            0,
            bg_none,
            30,
            bg_score_30,
            40,
            bg_score_40,
            50,
            bg_score_50,
            60,
            bg_score_60,
            70,
            bg_score_70,
            80,
            bg_score_80
          ]
        }
      });
    });

    // evento - al hacer click
    // detectar click sobre paises
    map.on("click", "global-shapes", function(e) {
      map.flyTo({
        center: e.lngLat,
        zoom: 5.1,
        speed: 1.1,
        curve: 2.5,
        easing: function(t) {
          return t;
        }
      });

      $("#country").text("- " + e.features[0].properties.name);
      //map.setView(e.latlng, 13);
    });

    // evento - al hacer click
    // detectar click sobre municipio
    map.on("click", "ods-cities-shapes", function(e) {
      // zoom hasta el municipio
      map.flyTo({
        center: e.lngLat,
        speed: 1.1,
        //zoom: 6,
        curve: 0,
        easing: function(t) {
          return t;
        }
      });

      var location_id = e.features[0].properties.location_id;

      $("#title-city").html(
        e.features[0].properties.name.replace(/_/g, " ") + " | "
      );
      $("#data").html(""); // reiniciamos los datos

      showElement("#reset-data-ods");
      paintIndicators(location_id);
      colorODS(location_id);
      updateRadar(my_radar, location_id);
      clearSearchCities();
    });

    // evento - al mover el ratón
    map.on("mousemove", "ods-cities-shapes", function(e) {
      // Change the cursor style as a UI indicator.
      map.getCanvas().style.cursor = "pointer";

      // Single out the first found feature.
      var feature = e.features[0];

      // Display a popup with the name of the county
      popup
        .setLngLat(e.lngLat)
        .setHTML(
          "<h2>" +
            feature.properties.name.replace(/_/g, " ") +
            "</h2><h3>Puntuación: <b>" +
            round(feature.properties.score) +
            "</b></h3>"
        )
        .addTo(map);

      //debugger;
      /*if (e.features.length > 0) {
						if (hoveredStateId) {
						map.setFeatureState({source: 'ods-cities', sourceLayer: 'data-a1vukm', id: hoveredStateId}, { hover: false});
						}
						hoveredStateId = feature.id; 
						map.setFeatureState({source: 'ods-cities', sourceLayer: 'data-a1vukm', id: hoveredStateId}, { hover: true});
						}*/
    });

    // evento - al mover el ratón fuera
    map.on("mouseleave", "ods-cities-shapes", function() {
      popup.remove(); // eliminar popup
      /*if (hoveredStateId) {
					map.setFeatureState({source: 'ods-cities', sourceLayer: 'data-a1vukm', id: hoveredStateId}, { hover: false});
				}
				hoveredStateId =  null;*/
    });

    // evento - al cargar los datos
    map.on("data", function(e) {
      if (
        e.dataType === "source" &&
        e.sourceId === "ods-cities" &&
        e.isSourceLoaded
      ) {
        document.getElementById("loader").style.visibility = "hidden";
      }
    });

    if (aux_data) {
      obtieneData();
      aux_data = false;
    }
  </script>
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143324389-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-143324389-1');
  </script>
</html>
